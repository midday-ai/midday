# Midday データベース ドキュメント

このフォルダには、Middayアプリケーションのデータベーススキーマに関する包括的なドキュメントが含まれています。

## ドキュメント一覧

### 1. [テーブル定義書_概要.md](./テーブル定義書_概要.md)
- データベース管理ツールの概要
- テーブル一覧（カテゴリ別）
- 列挙型（Enums）の定義
- 基本的な注意事項

### 2. [テーブル定義書_詳細.md](./テーブル定義書_詳細.md)
- 各テーブルの詳細なカラム定義
- データ型、制約、説明を含む完全なテーブル仕様
- 11のカテゴリに分類された全テーブルの詳細情報

### 3. [テーブル定義書_技術詳細.md](./テーブル定義書_技術詳細.md)
- インデックス戦略と詳細
- Row Level Security (RLS) ポリシー
- 外部キー制約とリレーション
- 生成列（Generated Columns）の定義
- カスタムデータ型
- マテリアライズドビュー
- パフォーマンス最適化手法
- セキュリティ設定

## データベース管理ツール

このプロジェクトでは以下のツールを使用してデータベーススキーマを管理しています：

- **ORM**: Drizzle ORM
- **マイグレーション管理**: Drizzle Kit
- **データベース**: PostgreSQL
- **スキーマ定義ファイル**: `packages/db/src/schema.ts`

## 主要な特徴

### 1. 多機能な財務管理システム
- 取引管理（transactions）
- 銀行口座連携（bank_accounts, bank_connections）
- 請求書管理（invoices, customers）
- 時間トラッキング（tracker_projects, tracker_entries）

### 2. 高度な検索機能
- 全文検索（tsvector）
- ベクトル検索（pgvector）
- トリグラム検索（trigram）

### 3. セキュアなアクセス制御
- Row Level Security (RLS)
- チームベースのアクセス制御
- OAuth統合

### 4. 柔軟なタグシステム
- 取引タグ
- ドキュメントタグ
- 顧客タグ
- プロジェクトタグ

### 5. インボックス機能
- メール統合
- 自動文書処理
- 取引との関連付け

## 使用方法

### 開発者向け
1. **概要ドキュメント**から全体の構造を把握
2. **詳細ドキュメント**で特定のテーブルの仕様を確認
3. **技術詳細ドキュメント**で実装時の技術的な考慮事項を確認

### データベース管理者向け
- インデックス戦略の確認
- パフォーマンス最適化の参考
- セキュリティ設定の確認

### アーキテクト向け
- データモデルの全体設計
- リレーション設計
- スケーラビリティ考慮事項

## 更新履歴

これらのドキュメントは `packages/db/src/schema.ts` から自動生成されています。
スキーマに変更があった場合は、このドキュメントも更新する必要があります。

## 関連ファイル

- `packages/db/src/schema.ts` - メインのスキーマ定義ファイル
- `packages/db/drizzle.config.ts` - Drizzle設定ファイル
- `apps/api/migrations/` - マイグレーションファイル

---

*最終更新: 2024年*

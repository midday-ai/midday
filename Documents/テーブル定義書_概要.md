# Midday データベース テーブル定義書

## 概要

このドキュメントは、Middayアプリケーションのデータベーススキーマ定義を説明します。PostgreSQLデータベースを使用し、Drizzle ORMでスキーマ管理を行っています。

## データベース管理ツール

- **ORM**: Drizzle ORM
- **マイグレーション管理**: Drizzle Kit
- **データベース**: PostgreSQL
- **スキーマ定義ファイル**: `packages/db/src/schema.ts`

## テーブル一覧

### 1. ユーザー・チーム関連
- `users` - ユーザー情報
- `teams` - チーム情報
- `users_on_team` - チームメンバー関係

### 2. 取引・財務関連
- `transactions` - 取引データ
- `transaction_categories` - 取引カテゴリ
- `bank_accounts` - 銀行口座
- `bank_connections` - 銀行接続

### 3. 請求書関連
- `invoices` - 請求書
- `customers` - 顧客
- `invoice_templates` - 請求書テンプレート

### 4. ドキュメント・ファイル関連
- `documents` - ドキュメント
- `document_tags` - ドキュメントタグ
- `document_tag_assignments` - ドキュメントタグ割り当て

### 5. トラッカー・プロジェクト関連
- `tracker_projects` - トラッカープロジェクト
- `tracker_entries` - トラッカーエントリ

### 6. インボックス・メール関連
- `inbox` - インボックス
- `inbox_accounts` - インボックスアカウント

### 7. タグ・分類関連
- `tags` - タグ
- `transaction_tags` - 取引タグ
- `customer_tags` - 顧客タグ

### 8. レポート・分析関連
- `reports` - レポート
- `tracker_reports` - トラッカーレポート

### 9. 認証・セキュリティ関連
- `api_keys` - APIキー
- `user_invites` - ユーザー招待

### 10. OAuth関連
- `oauth_applications` - OAuthアプリケーション
- `oauth_authorization_codes` - OAuth認可コード
- `oauth_access_tokens` - OAuthアクセストークン

### 11. その他
- `exchange_rates` - 為替レート
- `short_links` - 短縮リンク
- `transaction_enrichments` - 取引エンリッチメント

## 列挙型 (Enums)

### account_type
- depository (預金)
- credit (クレジット)
- other_asset (その他資産)
- loan (ローン)
- other_liability (その他負債)

### bank_providers
- gocardless
- plaid
- teller
- enablebanking

### connection_status
- disconnected (切断)
- connected (接続)
- unknown (不明)

### document_processing_status
- pending (保留)
- processing (処理中)
- completed (完了)
- failed (失敗)

### inbox_account_providers
- gmail
- outlook

### inbox_account_status
- connected (接続)
- disconnected (切断)

### inbox_status
- processing (処理中)
- pending (保留)
- archived (アーカイブ)
- new (新規)
- deleted (削除)
- done (完了)

### inbox_type
- invoice (請求書)
- expense (経費)

### invoice_delivery_type
- create (作成)
- create_and_send (作成・送信)
- scheduled (スケジュール)

### invoice_size
- a4
- letter

### invoice_status
- draft (下書き)
- overdue (期限超過)
- paid (支払済み)
- unpaid (未払い)
- canceled (キャンセル)
- scheduled (スケジュール)

### plans
- trial (トライアル)
- starter (スターター)
- pro (プロ)

### reportTypes
- profit (利益)
- revenue (収益)
- burn_rate (バーンレート)
- expense (経費)

### teamRoles
- owner (所有者)
- member (メンバー)

### trackerStatus
- in_progress (進行中)
- completed (完了)

### transactionCategories
- travel (旅行)
- office-supplies (事務用品)
- meals (食事)
- software (ソフトウェア)
- rent (家賃)
- income (収入)
- equipment (設備)
- transfer (振替)
- internet-and-telephone (インターネット・電話)
- facilities-expenses (施設費)
- activity (活動)
- uncategorized (未分類)
- taxes (税金)
- other (その他)
- salary (給与)
- fees (手数料)

### transactionMethods
- payment (支払い)
- card_purchase (カード購入)
- card_atm (カードATM)
- transfer (振替)
- other (その他)
- unknown (不明)
- ach (ACH)
- interest (利息)
- deposit (預金)
- wire (送金)
- fee (手数料)

### transactionStatus
- posted (記帳済み)
- pending (保留)
- excluded (除外)
- completed (完了)
- archived (アーカイブ)

### transaction_frequency
- weekly (週次)
- biweekly (隔週)
- monthly (月次)
- semi_monthly (半月)
- annually (年次)
- irregular (不定期)
- unknown (不明)

## 注意事項

1. **UUIDの使用**: ほとんどのテーブルでUUIDが主キーとして使用されています
2. **タイムスタンプ**: 作成日時は自動的に設定されます
3. **外部キー制約**: 適切な外部キー制約が設定されています
4. **カスケード削除**: 一部の関連テーブルではカスケード削除が設定されています
5. **デフォルト値**: 多くのカラムに適切なデフォルト値が設定されています

---

*このドキュメントは `packages/db/src/schema.ts` から自動生成されました。*
*最終更新: 2024年*
